一个进程中的所有线程共享该进程的地址空间，但它们**有各自独立的（/私有的）栈(stack)**，Windows线程的缺省堆栈大小为1M。堆(heap)的分配与栈有所不同，一般是一个进程有一个C运行时堆，这个堆为本进程中所有线程共享，windows进程还有所谓进程默认堆，用户也可以创建自己的堆。 
 用操作系统术语，线程切换的时候实际上切换的是一个可以称之为**线程控制块的结构（TCB?）**,里面保存所有将来用于恢复线程环境必须的信息，包括所有必须保存的寄存器集，线程的状态等。

 

**堆：是大家共有的空间**，分全局堆和局部堆。全局堆就是所有没有分配的空间，局部堆就是用户分配的空间。堆在操作系统对进程初始化的时候分配，运行过程中也可以向系统要额外的堆，但是记得用完了要还给操作系统，要不然就是内存泄漏。

**栈：是每个线程独有的**，保存其运行状态和局部自动变量的。**栈在线程开始的时候初始化，每个线程的栈互相独立，因此，栈是　thread safe的**。操作系统在切换线程的时候会自动的切换栈，就是切换　ＳＳ／ＥＳＰ寄存器。栈空间不需要在高级语言里面显式的分配和释放。



将`线程共有的信息存放在进程控制块中(PCB)，将线程独有的信息存放在线程控制块中(TCB)。`

![img](E:\笔记\Java面试笔记\images\1427627-20181213104509893-1478278426.png)