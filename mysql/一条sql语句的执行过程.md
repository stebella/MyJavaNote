查询语句的执行顺序：

１.**客户端通过TCP连接发送连接请求到mysql连接器**，`连接器`会对该请求进行权限验证及连接资源分配（max_connections，8小时超时）

２.**建立连接后客户端发送一条语句，mysql收到该语句后，通过命令`分发器`判断其是否是一条select语句**，如果是，在开启查询缓存的情况下，先在查询缓存中查找该SQL是否完全匹配，如果完全匹配，**验证当前用户是否具备查询权限**，如果权限验证通过，直接返回结果集给客户端，该查询也就完成了。如果不匹配继续向下执行。（注意：此步并不做词法及语法分析，也就是用不到分析器，这块原来我也很疑惑，如果不做分析mysql怎么知道我要查什么？解释如下：{MySQL将缓存存放在一个引用表中，通过一个哈希值引用，这个哈希值包括了以下因素，即查询本身、当前要查询的数据库、客户端协议的版本等一些其他可能影响返回结果的信息。  当判断缓存是否命中时，MySQL不会进行解析查询语句，而是直接使用SQL语句和客户端发送过来的其他原始信息。所以，任何字符上的不同，例如空格、注解等都会导致缓存的不命中。} 其实说白了大概就是拿着你的SQL和原始缓存的SQL比对）

3.如果在查询缓存中未匹配成功，则将**语句交给`分析器`作语法分析**，MySQL需要知道到底要查哪些东西，如果语法不对，就会返回语法错误中断查询。

4.分析器的工作完成后，将语句传递给**预处理器**，检查数据表和数据列是否存在，解析别名看是否存在歧义等

5.语句解析完成后，MySQL就知道要查什么了，之后会将语句传递给优化器进行优化（通过索引选择最快的查找方式），并**生成执行计划**。

6.之后交给执行器**去具体执行该语句**，在执行之前，会先检查该用户是否具有查询权限，如果有，继续执行该语句。执行器开始执行后，会逐渐将数据保存到结果集中，同时会逐步将数据缓存到查询缓存中，最终将结果集返回给客户端。（缓存到查询缓存受到几个参数的影响 1.query_cache_type 是否打开查询缓存,默认为OFF  2.query_cache_size:查询缓存使用的总内存空间,默认值为1M   3.query_cache_limit 对于大于该值的结果集不会被缓存，默认值1M，在8.0版本后该参数被移除了）（如果该SQL执行过程中超过了慢查询阀值，该SQL会被记录到慢查询日志中） 